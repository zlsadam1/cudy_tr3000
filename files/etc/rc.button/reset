#!/bin/sh

# 设置长按阈值 (秒)
LONG_PRESS_TIME=5

logger "DEBUG: Reset script started. Action: $ACTION, Seen: $SEEN"

[ "${ACTION}" = "pressed" ] && {
    # SEEN 是按键按下的持续时间（秒），由 kmod-gpio-button-hotplug 提供
    if [ "${SEEN}" -ge "$LONG_PRESS_TIME" ]; then
        logger "Reset button long-pressed (${SEEN}s): Factory reset triggered!"
        firstboot -y && reboot
    else
        logger "Reset button short-pressed (${SEEN}s): Log printed."
    fi
}
exit 0
